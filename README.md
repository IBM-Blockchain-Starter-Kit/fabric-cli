# Overview
The fabric-cli project is a Node.js application written using TypeScript, with the aim of making chaincode deployment simple.
The tool can be used to install, instantiate/upgrade and invoke chaincode running on any v1.4.x fabric network by creating a `net-config.json` (A number of example `net-config.json` files are included in the `examples/` directory).

The tool supports the following smart contract languages: Java, Golang and Node.js.

When attempting to deploy chaincode to a fabric network, the private key and certificate of the target Organizations's admin user are required:
- For IBP v2 these credentials can be exported via the `Wallet` tab, selecting the admin identity and clicking `Export Identity`. The exported credentials are base64 encoded and can be decoded in a Node.js runtime instance using:

      new Buffer('string_to_be_decoded', 'base64').toString()
- For local networks deployed using the IBM Blockchain Platform VSCode plugin, these credentials can be found in:
  
      ~/.fabric-vscode/local_fabric-ops/wallet/Admin@org1.example.com/

## Configuring the CLI
---

1. Go to root directory of project
2. Run `'npm install'`
3. Run `'npm run build'` to compile from TS into JS
4. Run `'chmod +x fabric-cli.js'` to make the file executable
5. Run the command `'npm link'`
6. Run the command `'fabric-cli --version'` to confirm the command is available from the cli
   
Note: Remember to run `'npm unlink'` once done to keep `npm` clean!


## Available Commands
---

Currently the following commands are implemented:

### Install Chaincode


```
fabric-cli chaincode install

Install chaincode

Options:
  --version     Show version number                                    [boolean]
  --help        Show help                                              [boolean]
  --net-config  Absolute path for network config file based on  FAB-5363 format
                                                             [string] [required]
  --org         Name of org stanza in the network-config file that contains the
                peers where the chaincode should be installed[string] [required]
  --crypto-dir  Absolute path for crypto material as generated by cryptogen tool
                                                             [string] [required]
  --cc-name     Name for the chaincode to install            [string] [required]
  --cc-version  The version that will be assigned to the chaincode to install
                                                             [string] [required]
  --cc-type     The langauge in which your chaincode is written, default=golang.
                                    [string] [choices: "golang", "java", "node"]
  --src-dir     Relative path to where the chaincode directory is located (for
                golang this is with respect to GOPATH/src)   [string] [required]
  --channel     Name of the channel to install chaincode     [string] [required]
               
Example:
> fabric-cli chaincode install --net-config /Users/jvines@uk.ibm.com/blockchain/git_repos/tooling/fabric-cli/examples/example-local-net-config.json --org org1 --cc-name marbles_chaincode  --cc-version 4 --channel mychannel --src-dir marbles/ --crypto-dir ./

```

### Instantiate Chaincode

```
fabric-cli chaincode instantiate

Instantiate chaincode

Options:
  --version             Show version number                            [boolean]
  --help                Show help                                      [boolean]
  --net-config          Absolute path for network config file based on  FAB-5363
                        format                               [string] [required]
  --org                 Name of org stanza in the network-config file that
                        contains the peers where the chaincode should be
                        installed                            [string] [required]
  --crypto-dir          Absolute path for crypto material as generated by
                        cryptogen tool                       [string] [required]
  --cc-name             Name for the chaincode to instantiate[string] [required]
  --cc-version          The version of chaincode to instantiate
                                                             [string] [required]
  --cc-type             The langauge in which your chaincode is written,
                        default=golang.
                                    [string] [choices: "golang", "java", "node"]
  --channel             Name of the channel to instantiate chaincode
                                                             [string] [required]
  --init-function       Function to call on instantiation call.
                                                      [string] [default: "init"]
  --init-args            Value(s) to pass as argument to instantiation call.
                                                           [array] [default: []]
  --timeout             Specify number of milliseconds to wait on the response
                        before rejecting.             [number] [default: 120000]
  --endorsement-policy  The endorsement policy for the chaincode (this is an
                        optional parameter).            [string] [default: null]
  
Example:
> fabric-cli chaincode instantiate --net-config /Users/jvines@uk.ibm.com/blockchain/git_repos/tooling/fabric-cli/examples/example-local-net-config.json --org org1 --cc-name marbles_chaincode  --cc-version 4 --channel mychannel  --crypto-dir ./ --init-function initMarble --init-args marble2 yellow 16 jason
  ```


### Invoke Chaincode


```
fabric-cli chaincode invoke

Invoke a transaction in the chaincode

Options:
  --version      Show version number                                   [boolean]
  --help         Show help                                             [boolean]
  --net-config   Absolute path for network config file based on  FAB-5363 format
                                                             [string] [required]
  --org          Name of org stanza in the network-config file that contains the
                 peers where the chaincode should be installed
                                                             [string] [required]
  --crypto-dir   Absolute path for crypto material as generated by cryptogen
                 tool                                        [string] [required]
  --cc-name      Name for the chaincode to invoke            [string] [required]
  --channel      Name of the channel to invoke chaincode     [string] [required]
  --invoke-fn    Name of the function to invoke in chaincode [string] [required]
  --invoke-args  Space separated list of arguments to pass into the invoked
                 function                                  [array] [default: []]
  --query        Specify if this invocation is just a query to the ledger
                                                      [boolean] [default: false]
  --timeout      Specify number of milliseconds to wait on the response before
                 rejecting                            [number] [default: 120000]


> fabric-cli chaincode invoke --cc-name marbles_chaincode --channel mychannel --invoke-fn initMarble --org org1 --net-config /Users/jvines@uk.ibm.com/blockchain/git_repos/tooling/fabric-cli/examples/example-local-net-config.json --crypto-dir ./ --invoke-args marble2 blue 35 darren
```